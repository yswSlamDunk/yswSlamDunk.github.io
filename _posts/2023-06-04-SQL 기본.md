---
layout : single
title : "[SQLD] 03. SQL 기본"
categories : [Certificate, SQLD]
tag : [DDL, DML, DCL, TCL, 트랜잭션, create, cascade, alter, drop, view, insert, update, delete, orderby distinct, where, like, between, in, having, count, 형변환, 내장형 함수, descode, case, rownum, rowid, with, grant, revoke, commit, rollback, savepoint]
---

## SQL 기본
### 관계형 데이터베이스
#### 관계형 데이터베이스 집합 연산과 관계 연산
* 집합 연산
    * 합집합(Union)
        * 두 개의 릴레리션을 하나로 합침
        * 중복된 행(튜플)은 한 번만 조회
    * 차집합(Difference)
        * 본래 릴레이션에는 존재하고 다른 릴레이션에는 존재하지 않는 것을 조회
    * 교집합(Intersection)
        * 두 개의 릴레이션 간에 공통된 것을 조회
    * 곱집합(Cartesian product)
        * 각 릴레이션에 존재하는 모든 데이터를 조합하녀 연산
* 관계 연산
    * 선택 연산(Selection)
        * 릴레이션에서 조건이 맞는 행(튜플)만 조회
    * 투영 연산(Projection)
        * 릴레이션에서 조건이 맞는 속성만을 조회
    * 결합 연산(Join)
        * 여러 릴레이션의 공통된 속성을 사용해서 새로운 릴레이션 생성
    * 나누기 연산(Division)
        * 기준 릴레이션에서 나누는 릴레이션이 가지고 있는 속성과 동일한 값을 가지는 행(튜플)을 추출하고 나누는 릴레이션의 속성을 삭제한 후 중복된 행을 제거하는 연산

#### SQL 종류
* SQL(Structured Query Language) 종류
    * DDL(Data Definition Language)
        * 데이터베이스의 구조를 정의하는 언어
        * CREATE, ALTER, DROP, RENAME, TRUNCATE
    * DML(Data Manipulation Language)
        * 테이블에서 데이터를 입력, 수정, 삭제, 조회
        * INSERT, UPDATE, DELETE, SELECT
    * DCL(Data Control Language)
        * 데이터베이스 사용자에게 권한을 부여하거나 회수
        * GRANT, REVOKE
    * TCL(Transaction Control Language)
        * 트랜잭션을 제어하는 명령어
        * COMMIT, REOLLBACK, SAVEPOINT
    
* 트랜잭션(Transaction)
    * 트랜잭션은 데이터 베이스의 작업을 처리하는 단위
    * 트랜잭션의 특성
        * 원자성
            * 트랜잭션은 데이터베이스 연산의 전부가 실행되거나 전혀 실행되지 않아야 함
            * 트랜잭션의 처리가 완전히 끝나지 않았을 경우, 실행되지 않은 상태와 같아야 함
        * 일관성
            * 트랜잭션 실행 결과로 데이터베이스의 상태가 모순되지 않아야 함
            * 트랜잭션 실행 후에도 일관성이 유지되어야 함
        * 고립성
            * 트랜잭션 실행 중, 생성하는 연산의 중간 결과는 다른 트랜잭션이 접근할 수 없음
            * 부분적인 실행 결과를 다른 트랜잭션이 볼 수 없음
        * 영속성
            * 트랜잭션이 성공적으로 완료하면 그 결과는 영구적 보장

* SQL 실행 순서
    * 파싱
        * SQL 문법 확인하고 구문 분석
    * 실행
        * 옵티마이저가 수립한 실행 계획에 따라 SQL 실행
    * 인출
        * 데이터를 읽어서 전송

### DDL(Data Definition Language)
* Create Table
* Alter Table
* Drop Table

#### 테이블 생성
```sql
Create Table DEPT(
    deptno varchar2(4) primary key,
    deptname varchar2(20)
);

Create Table EMP(
    empno number(10) primary key,
    ename varchar2(20),
    sal number(6, 2) default 0,
    deptno varchar2(4) not null,
    createdate date defualt sysdate,
    constraint emppk primary key(empno)
    constraint deptfk foreign key(deptno)
                    references dept (deptno)
                    on DELETE CASCADE
);
```

* "constraint"를 사용하여 기본키(empno)와 기본키의 이름(emppk)를 지정
* number(6, 2): 소수점 둘쨰 자리까지 저장
* sysdate: 오늘 날짜 시분초
* default: 기본값 설정
* not null: 결측치 불허
* 외래키
    * 외래키(foreign key)를 지정하려면, 먼저 참조당하는 테이블(DEPT)을 생성해야 함
    * EMP 테이블에서 DEPT 테이블을 참조
    * EMP 테이블을 생성할 떄, constraint를 사용하여 DEPT의 deptno 외래키 생성
* on DELETE CASCADE
    * CASCADE 옵션은 참조 관계가 있을 경우, 참조되는 데이터를 자동으로 반영할 수 있음
    * 만약 EMP 테이블에서 deptno의 값이 100인 값을 모두 삭제할 경우, DEPT 테이블에도 삭제 됨


#### 테이블 변경
```sql
-- 테이블명 변경
ALTER TABLE EMP
    RENAME TO NEW_EMP;

-- 칼럼 추가
ALTER TABLE EMP
    ADD (age number(2) default 1);

-- 컬럼 변경
ALTER TABLE EMP
    MODIFY (ename varchar2(40) not null);

--  컬럼 삭제
ALTER TABLE EMP
    DROP COLUMN age;

-- 컬럼명 변경
ALTER TABLE EMP
    RENAME COLUMN ename to new_ename'
```
        
